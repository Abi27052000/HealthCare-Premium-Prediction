name: Manual App Wake-Up

on:
  workflow_dispatch:
    inputs:
      app_url:
        description: "Streamlit App URL"
        required: false
        default: "https://healthcare-premium-prediction-27.streamlit.app/"
      timeout:
        description: "Request timeout (seconds)"
        required: false
        default: "30"

jobs:
  wake-up:
    runs-on: ubuntu-latest

    steps:
      - name: Wake up Streamlit app
        run: |
          APP_URL="${{ github.event.inputs.app_url || 'https://healthcare-premium-prediction-27.streamlit.app/' }}"
          TIMEOUT="${{ github.event.inputs.timeout || '30' }}"

          echo "ğŸš€ Waking up app: $APP_URL"
          echo "â±ï¸ Timeout set to: ${TIMEOUT}s"

          # Make the request
          if curl -f -s --max-time "$TIMEOUT" "$APP_URL" > /dev/null; then
            echo "âœ… Successfully woke up the app!"
            echo "ğŸ‰ App is now active and responding"
          else
            echo "âŒ Failed to wake up the app"
            echo "ğŸ” This might indicate an issue with the app or URL"
            exit 1
          fi

          echo "ğŸ“… Wake-up completed at: $(date)"
